sudo: false
language: scala
scala:
- 2.12.6
jdk:
- oraclejdk8

stages:
  - name: build
  - name: publish
    if: ((branch = master) AND (type != pull_request)) OR (tag IS present)

jobs:
  include:
    - stage: build
      script: sbt ++$TRAVIS_SCALA_VERSION test
    - stage: publish
      script: sbt ++$TRAVIS_SCALA_VERSION releaseEarly;

before_install:
- if [ $TRAVIS_PULL_REQUEST = 'false' ]; then
    openssl aes-256-cbc -K $encrypted_054593f98bbe_key -iv $encrypted_054593f98bbe_iv -in travis/secrets.tar.enc -out travis/secrets.tar -d;
    tar xv -C travis -f travis/secrets.tar;
  fi

env:
  global:
  - secure: "G/L9IDrk12lD5W4+j9V/h3/B0OcHengZUC16yR8hpqVvbgPJaslWfcVY/9T4KURAC8UHW2miVC2VHYrVM+JIshdFSfu9f1V+oDzL8ScxM0ULtAHxdQKroW7HBHx7ca0Vdkd56klMwtUtMu3ARamTxurlHxxHHrqFtJQLN4ybJI2+6RQRbwPw4M4iEXmc8IHpy5Ka4o021E92HOlDhay+cvSbUFlu+M3gOJgSZ8fMezFdzQxWH6KseabiJ+UdIpE6ii5/z7l6HuJeIXWq0KJMq+STtxwlO32UNTOvpkkUDf1HCX4PzUmaYlzSFBIuNh4or7wcQYdgerwRM80xDPg3s0PeZ613YDsiASV+xGxkKpHB/MAPd+Qxsyp9pyzZM8qkZRu0QcDvQvkXoPRd3c2I8fWIQuuuO3JN6l11todT3hz7cIS10Bo0IHM+F8NWGz8Et9hN6SqKF5dDLwd05EVesXa/B1LKCgUfqPkyjdWDLmCL7xaOZRLA833j8xJIlYq8kN4fS3Mz/hmfKQRLWEbEsE+wB9SvcI/pIQBJ0jr0n6ZEFsSfF51U9jTy+v3Jaa+f1RL6l/aWqGYGxHELCbnSavm/gxZSDQdQbBF4o7mSGh24Q7ZRNoe8+/P0+PGVrlxGV1GNHuIqq7PNillAV7GnLacU5Er9OJdeTMz/Rfr/PgY="
  - secure: "JMUnTIembgHWvDyeRjhmbTnx/HkmL0EA0cobpusE5194eLcnyXG2uv8HbieJcvWXG2+NIpcsiIewayHgC+ZF9JELUdo+9lHMpE1wsp4MLm2Njmpnjo0fpYlPC6ZGv+bSevB1ysXYq8HSWw0rKLOTQQK9ydSOsP5AYBJQyUbxJpg7bRrx2yTMaxhg5/7bTq9kbTVYHFN4bHsErsfKt6FZrSBoE44XGULC0yzy81ydj8yFLrrXo+37dYjHFD7Gy2lUqlEc4fXyrXUXYr1PNe5IZuX09GNsf3lIoRO8N6m6k1+KZ4pJiXKHoR9TmyNlrjk6r+HiafrV6Wv6sxBfs2UHc1AX00UtcQwm+UAgNLDgOIPZob9A22CPp35zJi//LyiZ9nwL9qECN8CVgQEqszHu0gBtpvk+J6kEFdrZeSKW2habFbNBAAoApxIY+dYI1SCaCZpueA59PwfiKP4wFPQrVgtR3G1tjK431+J2DhnunBVQXugBEFRoSpeeYlJAsr6AxiQz5MC8hmm8v1g8fh5AnapISgM3Fo0UTjnXHQEs2N95vFMKsJ3TordikEJCSRMBT2awIMDAfQ0zvOI+2p5J2dffin3DB4T4v7Y2zRmoF68F/Ds6wOMikarkBj2Sm8xoWk7aOTIqn8bL/9IBLprddYt+DbHFa81BCCOXHB4LRX0="
  - secure: "INV8I90M3Csci1166fJyj5Fa2Qxevgv+JdkSbiTERPg5EYQEAL8UYKBqJcEgfmA3uFBOCVIuNO9uYgFHvzIAB5yeFhEd2GfyFfIPyT3bLLLmkuE5wAXGUZVO4i3KKeEtGUUxuauvlBd8ZLMSZqXTigYxoAjFRYCAFCCSjNRMf7zE06zi2a4M5hu8Qzj+YJlKigTtRVs69zsH5OokRqVCa8V7+iDdVs3U3tMEPXu7/Z5YgDfYUw35GrVsDluj3NJzSz+tWoHWh4/Kis1ZgPLbuQybQZIcCm8PXcKMakoDuYYbXpDXC8hwbyHcIA9HaOQSVfhmb+J9KynFEIcpmZuvEU85lBw9OFC7e7a2l8hY2AD72vm8kzS8mV5ecg3uA4UDMa1CFaXkVdV+VALOClyLuQjKVk00DXLC5rlZEqV7pri+9FfoRT5UAQ0Xe6qMou3GGe4Cp7TvhsKlcjeGZ7H8rUu562Z8fZ2sXRKMj+BPZDoM6Z/2GV1aKR7UZNn+TRpj7eey+JI8mZg1HveNpaF86ruoMMh85lxUTbEpsMn4IysCzyVolYKGZgZlZ5rSu65fwmLXOKthd/xWgt1rKYnQDvKLf1LgV1RPGhxkMaRTyiFBxcsc+c+52D+5I/V0sCe2JVxz9C2t9IiHUWutUjWp8FLABPD0Zk/U3+CdQv+zk14="

cache:
  directories:
  - $HOME/.ivy2/cache
  - $HOME/.sbt
  - $HOME/.coursier
